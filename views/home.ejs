<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" >
  <meta name="description" content="">
  <meta name="author" content="Dashboard">
  <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
  <title>Nebular </title>
   <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">
<link href="/lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
  <!-- Bootstrap core CSS -->
  <link href="/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!--external css-->
  
  <link rel="stylesheet" type="text/css" href="/css/zabuto_calendar.css">
  <link rel="stylesheet" type="text/css" href="/lib/gritter/css/jquery.gritter.css" />
  <!-- Custom styles for this template -->
  <link href="/css/style.css" rel="stylesheet">
  <link href="/css/style-responsive.css" rel="stylesheet">
  <script src="/lib/chart-master/Chart.js"></script>

  
</head>

<body onload="bodyLoad()">
<div class="context">
  <section id="container">
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header black-bg">
      <div class="sidebar-toggle-box">
        
      </div>
      <!--logo start-->
      <a  class="logo"><img src="/img/sahara logo 1 .png" alt=""   class= "topLogo2" /></a>
      <!--logo end-->
      <div class="nav notify-row" id="top_menu">
        <!--  notification start -->
        <ul class="nav top-menu">
          <!-- settings start -->
          
           
          <!-- settings end -->
          <!-- inbox dropdown start-->
          <li id="header_inbox_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" >
              <i class="fa fa-clipboard"></i>
             
              </a>
            <ul class="dropdown-menu extended inbox">
              <div class="notify-arrow notify-arrow-green"></div>
              <li>
                <p class="green">Today's Duty Roaster</p>
              </li>
              <% var currentDateRoaster =  new Date().toLocaleDateString() %>
              
              <% var outp = '' %>
              <% for (let i = 0; i < data[0].teachers.length ; i++ ) { %>
               <% var object = data[0].teachers[i].duties  %>
                <% var todayssObject = object.filter((item)=>{return item.date === currentDateRoaster}) %>
                
                <% outp += todayssObject + ',' } %>
               
               
              
              <div id = "daRoaster"> </div>
           <script>
           var wat = ''
            var outp = [<%- outp %>]
             outp.forEach((item)=>{wat+=  `<li><a ><span class="photo"><img src="/img/bin/config.js/system/tc/${item.image}.jpg" alt="" /></span><span class="subject"><span class="from">${item.name}</span>
             <span class="time">${item.time}</span></span><span class="message" id="droaster">${item.duty}</span> </a></li> `	})
               	document.getElementById('daRoaster').innerHTML = wat
                </script>
                 </ul>
          </li>
          <!-- inbox dropdown end -->
          <!-- notification dropdown start-->
          <li id="header_notification_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" >
              <i class="fa fa-calendar"></i>
             
              </a>
            <ul class="dropdown-menu extended notification">
              <div class="notify-arrow notify-arrow-yellow"></div>
              <li>
                <p class="yellow">Upcoming School Events</p>
              </li>
              <% var upcoming = data[0].upcomingSchoolEvents %>
         <% var filerdEvents = upcoming.filter((ilem) => { return ilem.date >= currentDateRoaster  }) %>
       
              <% for(var z in filerdEvents){ %> 
              <li>
                <a >
                  <span class="label label-success"><i class="fa fa-bolt"></i></span>
                  
                 <%- filerdEvents[z].name %>: 
                  <span class="small italic">&nbsp;<%- filerdEvents[z].date%> </span>
                  </a>
              </li>
             
              <%}%>
             
            </ul>
          </li>
          <!-- notification dropdown end -->
        </ul>
        <!--  notification end -->
      
      </div>
      <button  class="wMenu" onclick="openNav()" >Menu</button>
      <div class="top-menu">
        <form action ="/logout?_method=DELETE" method="POST" class="nav pull-right top-menu">
          <button type ="submit" class="logout" >Logout</button>
        </form>
      </div> 
    </header>
    <!--header end-->
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    
    <aside>
      <div id="sidebar" class="nav-collapse ">
        <!-- sidebar menu start-->
        <ul class="sidebar-menu" id="nav-accordion">
          <p class="centered"><img   src="https://nebularimages.s3.eu-central-1.amazonaws.com/<%=data[0].image%>"  class="img-circle" ></p>
      
          <h5 class="centered"> <%= data[0].name %> </h5>
          <li class="mt">
            <a href="home">
              <i class="fa fa-home"></i>
              <span>Home</span>
              </a>
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-users"></i>
              <span>Students</span>
              </a>
            <ul class="sub">
              <li><a href="/allStudents/<%= id %>">All Students</a></li>
              <li><a href="/addStudent/<%= id %>">Add Student</a></li>
			 
              </ul>
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-male"></i>
              <span>Staff</span>
              </a>
            <ul class="sub">
              <li><a href="/allTeachers/<%= id %>">All Teachers</a></li>
              <li><a href="/addTeachers/<%=id%>">Add Teachers</a></li>
             
              
            
            </ul>
          </li>
         
          <li class="sub-menu">
            <a href="/events/<%= id %>">
              <i class="fa fa-calendar"></i>
              <span>Events & Activities</span>
              </a>
            
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-money"></i>
              <span>Fees</span>
              </a>
            <ul class="sub">
              <li><a href="/feesCollection/<%= id %>">Fees Collection</a></li>
              <li><a href="/addFees/<%=id%>">Add Fess</a></li>
              
            </ul>
          </li>
          <li>
           <a href="/textSmS/<%=id%>">
              <i class="fa fa-envelope"></i>
              <span>SMS Gateway </span>
        
              </a>
          </li>
          
         </ul>
      
         <% var wd = data[0].students %>
                  <ul id="myul">
                    <% for( g=0;g<wd.length;g++ ){ %>
                 
                    <% var studentsAttendanceArray = data[0].students[g] %>
                        
                       
                        <% var currentDate =  new Date().toLocaleDateString() %>
                     
                          
                       <% if( studentsAttendanceArray.dailyAttendance == currentDate  ){ %>
                       <% var array = 1 %>
                       
                      <li class = "attendCounter" ><%- array %></li>
                      
                      <%}%>
                      <%}%>
                       
                       
                       <ul id ='reportGraph'></ul>
                      </ul>
        <!-- sidebar menu end-->
      </div>
    </aside>
    <!--sidebar end-->
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    <!--main content start-->
    
     <!--main content start-->
	
    <section id="main-content" class="wrapper">
       
          <div class="col-lg-9 main-chart">
         
          
              <!-- SERVER STATUS PANELS -->
            
               <p style = "font-size:26px; color:#c7c7c7; text-shadow:1px 2px 2px black;" >Dashboard</p>
              <div class = "panels">
              <!-- /col-md-4-->
              <div class="col-md-4 col-sm-4 mb">
                <div class="red-panel pn"  id = "id1">
				
                  <div class="red-header">
                    <h5>Total Students</h5>
                  </div>
                   <div id = "server"><canvas id="serverstatus01" height="80" width="80"></canvas></div>
				 
                  <script >
                  
                 
                    var doughnutData = [{
                        value: 70,
                        color: "#2c323f"
                      },
                      {
                        value: 30,
                        color: "#fdfdfd"
                      }
                    ];
                    var myDoughnut = new Chart(document.getElementById("serverstatus01").getContext("2d")).Doughnut(doughnutData);
                  </script>

				  <footer id = "add" >
                    <div class="pull-left">
                  
					  
					  
                    </div>
                    <div class="pull-right">
					<% var studentsArray = data[0].students %>
                      <span class="totst"><h4><%-studentsArray.length%></h4></span> 
                    </div>
                  </footer>
                </div>
               </div>
           
              <!-- /col-md-4 -->
              <div class="col-md-4 col-sm-4 mb">
                <div class="green-panel pn" id = "id2">
                  <div class="green-header">
                    <h5>Day Attendance </h5>
                  </div>
                  <div id = "server2"><canvas id="serverstatus02" height="80" width="80"></canvas></div>
                  <script>
                    var doughnutData = [{
                        value: 80,
                        color: "#2c323f"
                      },
                      {
                        value: 20,
                        color: "#fdfdfd"
                      }
                    ];
                    var myDoughnut = new Chart(document.getElementById("serverstatus02").getContext("2d")).Doughnut(doughnutData);
                  </script>
                  
				  <footer>
                    <div class="pull-left">
                   <h4  id = "dailyAttendance" ></h4>
                      </div>
                    <div class="pull-right">
                      <h4 id = "attendancePercentage"> </h4>
                   
                      
                    </div>
                  </footer>
              </div>
            </div>
			 <!-- /col-md-4-->
			 <div class = "panel3">
              <div class="col-md-4 col-sm-4 mb">
                <div class="darkblue-panel pn" id = "id3">
                  <div class="darkblue-header">
                    <h5>New Students</h5>
                  </div>
                    <div id = "server3"><canvas id="serverstatus03" height="80" width="80"></canvas></div>
                  <script>
                    var doughnutData = [{
                        value: 80,
                        color: "#2c323f"
                      },
                      {
                        value: 20,
                        color: "#fdfdfd"
                      }
                    ];
                    var myDoughnut = new Chart(document.getElementById("serverstatus03").getContext("2d")).Doughnut(doughnutData);
                  </script>
				 
                  <footer>
                    <div class="pull-left">
                     <% var studentsArray = data[0].students %>
                     <% var newStudents = studentsArray.filter((studentsArray)=>{return studentsArray.newStudent === "true" })%>
                       <% var oldStudents = studentsArray.filter((studentsArray)=>{return studentsArray.newStudent === "false"})%>
                      <h4> <%- newStudents.length %></h4>
                    </div>
                    <div class="pull-right">
                   <%  var newPercentage =  (newStudents.length/studentsArray.length)*100 %>
                   <% var roundedPercentge = Math.floor(newPercentage) %>
                      <h4> <%- roundedPercentge %>%</h4>
                    </div>
                  </footer>
                </div>
				</div>
				</div>
                </div>
               
              </div>
              
        
			
			<div class = "12">
			
			    <div class="tab-pane" id="chartjs">
				
          <div class="row mt">
		  
            <div class="col-lg-6">
			
              <div class="content-panel">

                <h4> Enrolled</h4>
				
                <div class="panel-body text-center">
               <canvas id="doughnut" height="300%" width="310%"></canvas>
				 
                </div>
				
              </div>
			  <div class = "key"><ul>
			  <% var streams = data[0].streams %>
			  <% for(aq = 0 ;aq < streams.length ; aq++ ){ %> 
				<li>.</li>
				
				
				<%}%>
				</ul>
			</div>
			<div class = "key1"><ul>
			
			 <% for(aq1 = 0 ;aq1 < streams.length ; aq1++ ){ %> 
			 <% var id = streams[aq1] %>
              <% var count = studentsArray.filter((obj) => obj.stream === id).length %>
              <% if (count<2 ){var student = "Student"} else {var student = "Students"} %>
				<li><%- streams[aq1]%>:&nbsp;<%- count%></li>
				
				<%}%>
				
				</ul>
				
			</div>
            </div>
			
            <div class="col-lg-6">
              <div class="content-panel">
                <h4></i> Stream Pass Rate/Term</h4>
                <div id = "graphText"><p>Average Mark %</p></div>
                <div class="panel-body text-center">
                  <canvas id="line" height="300" width="360%"></canvas>
                  <div class = "key12"><ul>
			       <li>.</li>
			       <li>.</li>
				</ul>
			</div>
			<div class = "key11"><ul id="streamKey">
			
				
				</ul>
				
			</div>
            </div>
				  </div>
                </div>
              </div>
            </div>
          </div>
		 
          <div class="col-lg-3 ds">
            <!--COMPLETED ACTIONS DONUTS CHART-->
            <div class="donut-main">
              
              
            </div>
			  
        <!-- page start-->
     
            <!--NEW EARNING STATS -->
            <div class="panel terques-chart">
              <div class="panel-body " id="panel-body2">
                <div class="chart">
                  <div class="centered">
                   
              </div>
            </div>
			
            <!--new earning end-->
            <!-- RECENT ACTIVITIES SECTION -->
            <h4 class="centered mt">Today's Time Table</h4>
            <!-- First Activity -->
            
           
     <div id="timeTable1">
            
           </div>
            </div>
            </div>
            </div>
           
      <script>
      	function openNav() {document.getElementById("sidebar").style.display= "block";}

      </script>  
         
<script>
     var dadays = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"]
      var todaysDay = new Date()
        var nday = dadays[todaysDay.getDay()]
         var time =  `<%- data[0].timeShedule %>`
          var timeArrayOg = time.split(',')
             
            if ( nday === "Monday" ){var subjct = <%- data[0].classes %>.Monday}
             else if ( nday === "Tuesday" ){ var subjct = <%- data[0].classes %>.Tuesday}
              else if ( nday === "Wednesday" ){ var subjct = <%- data[0].classes %>.Wednesday}
               else if ( nday === "Thursday" ){ var subjct = <%- data[0].classes %>.Thursday}
                else if ( nday === "Friday" ){ var subjct = <%- data[0].classes %>.Friday}
                
                  var ttOutPut = ''
                   for (var tmtb in timeArrayOg){
                    var ty = timeArrayOg[tmtb]
                     var ty2 = ty.split(',')
        
                       var checker = value => ty2.some(element => value.includes(element))
                        var thearray = subjct.filter(checker)
                         var lessons = ''
                          for (var ir in thearray) 
                           if (thearray.hasOwnProperty(ir)) { 
                            var subjectsperTimeSlot = thearray[ir][1] 
                             lessons += `|${thearray[ir][2]}: ${thearray[ir][1]}|` }
                             
                               ttOutPut +=  ` <div class="desc">
                                <div class="thumb">
                                 <span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                                  </div>
                                   <div class="2">
                                     <p><muted>${timeArrayOg[tmtb]} am</muted><br/><a style ="color:#949ba2" id="testtt1"> Lessons:${lessons}  </a></p>
                                      </div></div> ` }
                                       document.getElementById('timeTable1').innerHTML = ttOutPut
</script>  
     </section>
     </section>
     </div>
<!-- js placed at the end of the document so the pages load faster -->
  <script src="/lib/jquery/jquery.min.js"></script>

  <script src="/lib/bootstrap/js/bootstrap.min.js"></script>
  <script class="include" type="text/javascript" src="/lib/jquery.dcjqaccordion.2.7.js"></script>
  <script src="/lib/jquery.scrollTo.min.js"></script>
  <script src="/lib/jquery.nicescroll.js" type="text/javascript"></script>
  <script src="/lib/jquery.sparkline.js"></script>
  <!--common script for all pages-->
  <script src="/lib/common-scripts.js"></script>
  <script type="text/javascript" src="/lib/gritter/js/jquery.gritter.js"></script>
  <script type="text/javascript" src="/lib/gritter-conf.js"></script>
  <!--script for this page-->
 
  <!--script for this page-->
  <script src="/lib/sparkline-chart.js"></script>
  <script src="/lib/zabuto_calendar.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      var unique_id = $.gritter.add({
        // (string | mandatory) the heading of the notification
        title: 'Welcome to Nebular!',
        // (string | mandatory) the text inside the notification
        text: 'You are now connected to your schools database. You can now manage your information in a very flexible and effective manner. ',
        // (string | optional) the image to display on the left
       
        sticky: false,
        // (int | optional) the time you want it to be alive for before fading out
        time: 8000,
        // (string | optional) the class name you want to apply to that specific message
        class_name: 'my-sticky-class'
      });

      return false;
    });
  </script>
  <script type="application/javascript">
    $(document).ready(function() {
      $("#date-popover").popover({
        html: true,
        trigger: "manual"
      });
      $("#date-popover").hide();
      $("#date-popover").click(function(e) {
        $(this).hide();
      });

      $("#my-calendar").zabuto_calendar({
        action: function() {
          return myDateFunction(this.id, false);
        },
        action_nav: function() {
          return myNavFunction(this.id);
        },
        ajax: {
          url: "show_data.php?action=1",
          modal: true
        },
        legend: [{
            type: "text",
            label: "Special event",
            badge: "00"
          },
          {
            type: "block",
            label: "Regular event",
          }
        ]
      });
    });

    function myNavFunction(id) {
      $("#date-popover").hide();
      var nav = $("#" + id).data("navigation");
      var to = $("#" + id).data("to");
      console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
    }
  </script>
  <script>
  	
  	const container = document.querySelector('.red-panel');
  	const container2 = document.querySelector('.darkblue-panel');
  	const container3 = document.querySelector('.green-panel');
  	

function bodyLoad(){
	
      
 container.classList.replace('red-panel', 'red-panel1')
	container2.classList.replace('darkblue-panel', 'darkblue-panel1')
	container3.classList.replace('green-panel', 'green-panel1')
    var liList = document.getElementById("myul").getElementsByTagName("li");
    var largo = liList.length
    var studentsArray = `<%- data[0].students %>` ;
    var totalStudentList = studentsArray.length
    var percentage =   Math.floor( (largo/totalStudentList)*100 )
	document.getElementById("dailyAttendance").innerHTML = largo
	document.getElementById("attendancePercentage").innerHTML = `${percentage}%`
	
	}
	
  </script>
  
  <script>var Script = function () {
var streams = `<%- data[0].streams %>`
 var streamsArray = streams.split(',')
 
if( streamsArray.length === 6){var doughnutData = [{value:30,color:"green"},{value:20,color:"yellow"},{value:20,color:"red"},{ value:40,color:"black"},{value:10,color:"white"},{value:40,color:"blue" }]; document.getElementById('streamKey').innerHTML = `<li>Form 4</li><li>Form 6</li>` } else if (streamsArray.length === 1){var doughnutData = [ {value: 30,color:"green" } ]}
else if (streamsArray.length === 7){var doughnutData = [{value: 30,color:"green"},{ value:20,color:"yellow"},{value:20,color:"red"},{value:40,color:"black"},{value:10,color:"white"},{value:40,color : "blue"},{ value : 20, color : "blue" } ] ; document.getElementById('streamKey').innerHTML = `<li>Grade 7</li><li>ECD</li>`}   
else if (streamsArray.length === 8){var doughnutData = [{value:30,color:"green"},{value:20,color:"yellow"},{value:20,color:"red"},{value:40,color:"black"},{value: 10,color : "white"},{value : 40,color : "blue"},{value : 20,color : "blue"},{value : 20,color : "blue"}]  ; document.getElementById('streamKey').innerHTML = `<li>Grade 7</li><li>ECD</li>`} 
 else if (streamsArray.length === 13) {var doughnutData = [{ value: 30,color:"green"},{value : 20,color : "yellow"},{value : 20,color : "red"},
{value : 40,color : "black"},{value : 10,color : "white"},{value : 40,color : "blue"},{value : 20,color : "blue" },{value : 20,color : "blue" },{value : 40,color : "black"},{value : 10,color : "white"},{ value : 40, color : "blue"}, { value : 20,color : "blue"},{value : 20,color : "blue"}]; document.getElementById('streamKey').innerHTML = `<li>Form 4</li><li>Form 6</li>` }
   else if (streamsArray.length === 14) {var doughnutData = [{ value: 30,color:"green"},{value : 20,color : "yellow"},{value : 20,color : "red"},
{value : 40,color : "black"},{value : 10,color : "white"},{value : 40,color : "blue"},{value : 20,color : "blue" },{value : 20,color : "blue" },{value : 40,color : "black"},{value : 10,color : "white"},{ value : 40, color : "blue"}, { value : 20,color : "blue"},{value : 20,color : "blue"},{value : 20,color : "blue"}] ; document.getElementById('streamKey').innerHTML = `<li>Form 4</li><li>Form 6</li>`} 
    

var subjects = `<%- data[0].subjects %>`
var subjectsArray = subjects.split(',')
 <% var allSubjects =  data[0].subjects %>
         <% var allStudents = data[0].students %>
          <% const groups = allStudents.reduce((groups, item) => ({ ...groups,[item.stream]: [...(groups[item.stream] || []), item]}), {})%>
           <% var stream = groups.Form4 %>
            <% var output = '' %>
             <% for (var a in stream){ %>
              <% var subjectLearntArray =  stream[a].subjectsLearnt %>
               <%  output += subjectLearntArray + ','  %>
               
                <%    } %>
               var form4Array = []
                 var allSubjects = subjectsArray
                  var output = new Array(`<%- output %>`)
                   var objectStringArray = (new Function("return [" + output+ "];")())
                    for( ac = 0;ac < allSubjects.length ; ac++ ){ 
                     var subjectFilter = objectStringArray.filter( (subj) => { return  subj.subject === allSubjects[ac] })
                      var test = subjectFilter.map( (subw) => subw.inClassTest )
                       const flattened = [].concat(...test)
                        var totalInClassTest = flattened.reduce((currentTotal,flattened)=> {return flattened.Mark + currentTotal } ,0)
                         var allStudentsStream = flattened.length
                           var averageResult = totalInClassTest/allStudentsStream
                            var roundedPercentgeForm4 = Math.floor(averageResult)
                             form4Array.push(roundedPercentgeForm4)}
                             
                               
 var subjects1 = `<%- data[0].subjects %>`
var subjectsArray1 = subjects1.split(',')
 <% var allSubjects1 =  data[0].subjects %>
         <% var allStudents1 = data[0].students %>
          <% var groups1 = allStudents1.reduce((groups1, item1) => ({ ...groups1,[item1.stream]: [...(groups1[item1.stream] || []), item1]}), {})%>
           <% var stream1 = groups1.Form6 %>
            <% var output1 = '' %>
             <% for (var a in stream1){ %>
              <% var subjectLearntArray1 =  stream1[a].subjectsLearnt %>
               <%  output1 += subjectLearntArray1 + ','  %>
              
                <%    } %>
               var form4Array1 = []
                 var allSubjects1 = subjectsArray1
                  var output1 = new Array(`<%- output1 %>`)
                   var objectStringArray1 = (new Function("return [" + output1+ "];")())
                    for( ac1 = 0;ac1 < allSubjects1.length ; ac1++ ){ 
                     var subjectFilter1 = objectStringArray1.filter( (subj1) => { return  subj1.subject === allSubjects1[ac1] })
                      var test1 = subjectFilter1.map( (subw1) => subw1.inClassTest )
                       var flattened1 = [].concat(...test1)
                        var totalInClassTest1 = flattened1.reduce((currentTotal,flattened1)=> {return flattened1.Mark + currentTotal } ,0)
                         var allStudentsStream1 = flattened1.length
                           var averageResult1 = totalInClassTest1/allStudentsStream1
                            var roundedPercentgeForm41 = Math.floor(averageResult1)
                          
                             form4Array1.push(roundedPercentgeForm41) }
                            
                             var subjects11 = `<%- data[0].subjects %>`
var subjectsArray11 = subjects11.split(',')
 <% var allSubjects11 =  data[0].subjects %>
         <% var allStudents11 = data[0].students %>
          <% var groups11 = allStudents11.reduce((groups11, item11) => ({ ...groups11,[item11.stream]: [...(groups11[item11.stream] || []), item11]}), {})%>
           <% var stream11 = groups11.Grade7 %>
            <% var output11 = '' %>
             <% for (var a in stream11){ %>
              <% var subjectLearntArray11 =  stream11[a].subjectsLearnt %>
               <%  output11 += subjectLearntArray11 + ','  %>
              
                <%    } %>
               var form4Array2 = []
                 var allSubjects11 = subjectsArray11
                  var output11 = new Array(`<%- output11 %>`)
                   var objectStringArray11 = (new Function("return [" + output11+ "];")())
                    for( ac11 = 0;ac11 < allSubjects11.length ; ac11++ ){ 
                     var subjectFilter11 = objectStringArray11.filter( (subj11) => { return  subj11.subject === allSubjects11[ac11] })
                      var test11 = subjectFilter11.map( (subw11) => subw11.inClassTest )
                       var flattened11 = [].concat(...test11)
                        var totalInClassTest11 = flattened11.reduce((currentTotal,flattened11)=> {return flattened11.Mark + currentTotal } ,0)
                         var allStudentsStream11 = flattened11.length
                           var averageResult11 = totalInClassTest11/allStudentsStream11
                            var roundedPercentgeForm411 = Math.floor(averageResult11)
                          
                             form4Array2.push(roundedPercentgeForm411)
                            
                             
                             }
                             
                 
var lineChartData =  {
	
        labels : subjectsArray ,
    
        datasets : [
            {   label: "Form 4",
               
                fillColor : " rgba(0, 0, 255, 0.2)",
                strokeColor : "rgba(0, 0, 255, 0.2)",
                pointColor : "grey",
                pointStrokeColor : "rgba(0, 0, 255, 0.2)",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(220,220,220,1)",
                data : form4Array
            },
            {
            	label: "Form 6",
                fillColor : "rgba(0, 255, 0, 0.3)",
                strokeColor :"rgba(0, 255, 0, 0.3)",
                pointColor : "grey",
                pointStrokeColor : "rgba(0, 255, 0, 0.3)",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(220,220,220,3)",
                data : form4Array1
            },
            
             {   label: "Grade 7",
               
                fillColor : " rgba(0, 0, 215, 0.1)",
                strokeColor : "rgba(0, 0, 215, 0.1)",
                pointColor : "grey",
                pointStrokeColor : "rgba(0, 0, 215, 0.1)",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(220,220,220,1)",
                data : form4Array2
            }
        ]
        

    };
    
  
    
        
         
        
        
        
        
    new Chart(document.getElementById("doughnut").getContext("2d")).Doughnut(doughnutData);
    new Chart(document.getElementById("line").getContext("2d")).Line(lineChartData);
 

}();</script>

</body>

</html>

